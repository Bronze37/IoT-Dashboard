{"ast":null,"code":"var _jsxFileName = \"D:\\\\B\\xE0i t\\u1EADp\\\\IoT\\\\BTL\\\\BTL\\\\client\\\\src\\\\pages\\\\Dashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport Swal from 'sweetalert2';\nimport Cards from '../components/Cards';\nimport Clock from '../components/Clock';\nimport Led from '../components/Led';\nimport DataChart from '../components/DataChart';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Dashboard = ({\n  temp,\n  setTemp,\n  humi,\n  setHumi,\n  light,\n  setLight,\n  label,\n  setLabel,\n  tempCard,\n  setTempCard,\n  humiCard,\n  setHumiCard,\n  lightCard,\n  setLightCard,\n  bgHumi,\n  setBgHumi,\n  bgTemp,\n  setBgTemp,\n  bgLight,\n  setBgLight,\n  isCheckedLight,\n  setIsCheckedLight,\n  isCheckedFan,\n  setIsCheckedFan,\n  dbCard,\n  setDbCard,\n  db,\n  setDb,\n  isCheckedAirCon,\n  setIsCheckedAirCon,\n  bgDb,\n  setBgDb\n}) => {\n  _s();\n  const [lastAlertTime, setLastAlertTime] = useState(0);\n  const [lastLightAlertTime, setLastLightAlertTime] = useState(0);\n\n  // Thiết lập kết nối WebSocket\n  useEffect(() => {\n    ws.current = new WebSocket('ws://your-websocket-endpoint');\n    ws.current.onopen = () => console.log('WebSocket connection opened');\n    ws.current.onclose = () => console.log('WebSocket connection closed');\n    return () => {\n      ws.current.close();\n    };\n  }, []);\n\n  // Hàm để gửi lệnh tắt thiết bị qua WebSocket\n  const turnOffDevices = () => {\n    if (ws.current && ws.current.readyState === WebSocket.OPEN) {\n      ws.current.send(JSON.stringify({\n        action: 'turnOffDevices',\n        devices: {\n          light: false,\n          fan: false,\n          airCon: false\n        }\n      }));\n    }\n  };\n\n  // Hàm cảnh báo nhiệt độ cao\n  useEffect(() => {\n    const now = Date.now();\n    if (temp.some(t => t > 35) && now - lastAlertTime > 30000) {\n      Swal.fire({\n        title: 'Cảnh báo!',\n        text: 'Nhiệt độ cao!',\n        icon: 'warning',\n        confirmButtonText: 'OK',\n        confirmButtonColor: '#333333'\n      });\n      // Tắt hết thiết bị điện\n      setIsCheckedLight(false);\n      setIsCheckedFan(false);\n      setIsCheckedAirCon(false);\n      turnOffDevices();\n      setLastAlertTime(now);\n    }\n  }, [temp, lastAlertTime]);\n\n  // Hàm cảnh báo ánh sáng cao\n  useEffect(() => {\n    const now = Date.now();\n    if (light.some(l => l > 400) && now - lastLightAlertTime > 60000) {\n      Swal.fire({\n        title: 'Cảnh báo!',\n        text: 'Ánh sáng quá mạnh!',\n        icon: 'warning',\n        confirmButtonText: 'OK',\n        confirmButtonColor: '#333333'\n      });\n      // Tắt hết thiết bị điện\n      setIsCheckedLight(false);\n      setIsCheckedFan(false);\n      setIsCheckedAirCon(false);\n      turnOffDevices();\n      setLastLightAlertTime(now);\n    }\n  }, [light, lastLightAlertTime]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"hr\", {\n      className: \"mr-[100px]\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mr-[100px] mt-10\",\n      children: /*#__PURE__*/_jsxDEV(Cards, {\n        tempCard: tempCard,\n        setTempCard: setTempCard,\n        humiCard: humiCard,\n        setHumiCard: setHumiCard,\n        lightCard: lightCard,\n        setLightCard: setLightCard,\n        bgHumi: bgHumi,\n        setBgHumi: setBgHumi,\n        bgTemp: bgTemp,\n        setBgTemp: setBgTemp,\n        bgLight: bgLight,\n        setBgLight: setBgLight,\n        dbCard: dbCard,\n        setDbCard: setDbCard,\n        bgDb: bgDb,\n        setBgDb: setBgDb\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-[40px] mr-[120px] flex justify-around items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-[70%]\",\n        children: /*#__PURE__*/_jsxDEV(DataChart, {\n          temp: temp,\n          setTemp: setTemp,\n          humi: humi,\n          setHumi: setHumi,\n          light: light,\n          setLight: setLight,\n          label: label,\n          setLabel: setLabel,\n          dbCard: dbCard,\n          setDbCard: setDbCard,\n          db: db,\n          setDb: setDb\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-[30%]\",\n        children: /*#__PURE__*/_jsxDEV(Led, {\n          isCheckedLight: isCheckedLight,\n          setIsCheckedLight: setIsCheckedLight,\n          isCheckedFan: isCheckedFan,\n          setIsCheckedFan: setIsCheckedFan,\n          isCheckedAirCon: isCheckedAirCon,\n          setIsCheckedAirCon: setIsCheckedAirCon\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 9\n  }, this);\n};\n_s(Dashboard, \"EFmHJH3JRTT8ikdtlSmbFq3ljwk=\");\n_c = Dashboard;\nexport default Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Swal","Cards","Clock","Led","DataChart","jsxDEV","_jsxDEV","Dashboard","temp","setTemp","humi","setHumi","light","setLight","label","setLabel","tempCard","setTempCard","humiCard","setHumiCard","lightCard","setLightCard","bgHumi","setBgHumi","bgTemp","setBgTemp","bgLight","setBgLight","isCheckedLight","setIsCheckedLight","isCheckedFan","setIsCheckedFan","dbCard","setDbCard","db","setDb","isCheckedAirCon","setIsCheckedAirCon","bgDb","setBgDb","_s","lastAlertTime","setLastAlertTime","lastLightAlertTime","setLastLightAlertTime","ws","current","WebSocket","onopen","console","log","onclose","close","turnOffDevices","readyState","OPEN","send","JSON","stringify","action","devices","fan","airCon","now","Date","some","t","fire","title","text","icon","confirmButtonText","confirmButtonColor","l","children","className","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/Bài tập/IoT/BTL/BTL/client/src/pages/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport Swal from 'sweetalert2';\r\nimport Cards from '../components/Cards';\r\nimport Clock from '../components/Clock';\r\nimport Led from '../components/Led';\r\nimport DataChart from '../components/DataChart';\r\n\r\nconst Dashboard = ({\r\n    temp,\r\n    setTemp,\r\n    humi,\r\n    setHumi,\r\n    light,\r\n    setLight,\r\n    label,\r\n    setLabel,\r\n    tempCard,\r\n    setTempCard,\r\n    humiCard,\r\n    setHumiCard,\r\n    lightCard,\r\n    setLightCard,\r\n    bgHumi,\r\n    setBgHumi,\r\n    bgTemp,\r\n    setBgTemp,\r\n    bgLight,\r\n    setBgLight,\r\n    isCheckedLight,\r\n    setIsCheckedLight,\r\n    isCheckedFan,\r\n    setIsCheckedFan,\r\n    dbCard,\r\n    setDbCard,\r\n    db,\r\n    setDb,\r\n    isCheckedAirCon,\r\n    setIsCheckedAirCon,\r\n    bgDb,\r\n    setBgDb\r\n}) => {\r\n    const [lastAlertTime, setLastAlertTime] = useState(0);\r\n    const [lastLightAlertTime, setLastLightAlertTime] = useState(0);\r\n    \r\n\r\n    // Thiết lập kết nối WebSocket\r\n    useEffect(() => {\r\n        ws.current = new WebSocket('ws://your-websocket-endpoint');\r\n        ws.current.onopen = () => console.log('WebSocket connection opened');\r\n        ws.current.onclose = () => console.log('WebSocket connection closed');\r\n        return () => {\r\n            ws.current.close();\r\n        };\r\n    }, []);\r\n\r\n    // Hàm để gửi lệnh tắt thiết bị qua WebSocket\r\n    const turnOffDevices = () => {\r\n        if (ws.current && ws.current.readyState === WebSocket.OPEN) {\r\n            ws.current.send(JSON.stringify({\r\n                action: 'turnOffDevices',\r\n                devices: {\r\n                    light: false,\r\n                    fan: false,\r\n                    airCon: false\r\n                }\r\n            }));\r\n        }\r\n    };\r\n\r\n    // Hàm cảnh báo nhiệt độ cao\r\n    useEffect(() => {\r\n        const now = Date.now();\r\n        if (temp.some(t => t > 35) && now - lastAlertTime > 30000) {\r\n            Swal.fire({\r\n                title: 'Cảnh báo!',\r\n                text: 'Nhiệt độ cao!',\r\n                icon: 'warning',\r\n                confirmButtonText: 'OK',\r\n                confirmButtonColor: '#333333'\r\n            });\r\n            // Tắt hết thiết bị điện\r\n            setIsCheckedLight(false);\r\n            setIsCheckedFan(false);\r\n            setIsCheckedAirCon(false);\r\n            turnOffDevices();\r\n\r\n            setLastAlertTime(now);\r\n        }\r\n    }, [temp, lastAlertTime]);\r\n\r\n    // Hàm cảnh báo ánh sáng cao\r\n    useEffect(() => {\r\n        const now = Date.now();\r\n        if (light.some(l => l > 400) && now - lastLightAlertTime > 60000) {\r\n            Swal.fire({\r\n                title: 'Cảnh báo!',\r\n                text: 'Ánh sáng quá mạnh!',\r\n                icon: 'warning',\r\n                confirmButtonText: 'OK',\r\n                confirmButtonColor: '#333333'\r\n            });\r\n            // Tắt hết thiết bị điện\r\n            setIsCheckedLight(false);\r\n            setIsCheckedFan(false);\r\n            setIsCheckedAirCon(false);\r\n            turnOffDevices();\r\n\r\n            setLastLightAlertTime(now);\r\n        }\r\n    }, [light, lastLightAlertTime]);\r\n\r\n    return (\r\n        <div>\r\n            {/* <strong className=\"h-[90px] border-b mr-[100px] flex justify-start items-center\">\r\n                <h1>DASHBOARD</h1>\r\n                <Clock />\r\n            </strong> */}\r\n            <hr className=\"mr-[100px]\" />\r\n\r\n            <div className=\"mr-[100px] mt-10\">\r\n                <Cards\r\n                    tempCard={tempCard}\r\n                    setTempCard={setTempCard}\r\n                    humiCard={humiCard}\r\n                    setHumiCard={setHumiCard}\r\n                    lightCard={lightCard}\r\n                    setLightCard={setLightCard}\r\n                    bgHumi={bgHumi}\r\n                    setBgHumi={setBgHumi}\r\n                    bgTemp={bgTemp}\r\n                    setBgTemp={setBgTemp}\r\n                    bgLight={bgLight}\r\n                    setBgLight={setBgLight}\r\n                    dbCard={dbCard}\r\n                    setDbCard={setDbCard}\r\n                    bgDb={bgDb}\r\n                    setBgDb={setBgDb}\r\n                />\r\n            </div>\r\n\r\n            <div className=\"mt-[40px] mr-[120px] flex justify-around items-center\">\r\n                <div className=\"w-[70%]\">\r\n                    <DataChart\r\n                        temp={temp}\r\n                        setTemp={setTemp}\r\n                        humi={humi}\r\n                        setHumi={setHumi}\r\n                        light={light}\r\n                        setLight={setLight}\r\n                        label={label}\r\n                        setLabel={setLabel}\r\n                        dbCard={dbCard}\r\n                        setDbCard={setDbCard}\r\n                        db={db}\r\n                        setDb={setDb}\r\n                    />\r\n                </div>\r\n                <div className=\"w-[30%]\">\r\n                    <Led\r\n                        isCheckedLight={isCheckedLight}\r\n                        setIsCheckedLight={setIsCheckedLight}\r\n                        isCheckedFan={isCheckedFan}\r\n                        setIsCheckedFan={setIsCheckedFan}\r\n                        isCheckedAirCon={isCheckedAirCon}\r\n                        setIsCheckedAirCon={setIsCheckedAirCon}\r\n                    />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Dashboard;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}